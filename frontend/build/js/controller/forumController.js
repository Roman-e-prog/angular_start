"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateForum=exports.getForum=exports.getAllUserForum=exports.getAllForum=exports.forumViewsCount=exports.forumLikesCount=exports.forumDislikesCount=exports.deleteForum=exports.createForum=void 0;var _dbconnect=_interopRequireDefault(require("../db/dbconnect"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}const createForum=async(t,e)=>{const{username:o,user_id:s,question_ressort:r,question_theme:u,question:n}=t.body;try{const t=await _dbconnect.default.query("INSERT INTO forum (username, user_id, question_ressort, question_theme, question, created_at, updated_at) VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING *",[o,s,r,u,n,new Date((new Date).toISOString()),new Date((new Date).toISOString())]);e.status(200).json(t.rows[0])}catch(t){e.status(403).json("Upload nicht möglich")}};exports.createForum=createForum;const updateForum=async(t,e)=>{const{question_theme:o,question:s}=t.body,r=t.params.id;try{const t=await _dbconnect.default.query("UPDATE forum SET question_theme =$1, question = $2, updated_at = $3 WHERE id = $4",[o,s,new Date((new Date).toISOString()),r]);e.status(200).json(t.rows[0])}catch(t){e.status(404).json("Nicht gefunden")}};exports.updateForum=updateForum;const deleteForum=async(t,e)=>{const o=t.params.id;try{await _dbconnect.default.query("DELETE FROM forum WHERE id = $1",[o]),e.status(200).json(`Forumeintrag mit der id ${o} wurde gelöscht`)}catch(t){e.status(404).json("Nicht gefunden")}};exports.deleteForum=deleteForum;const getForum=async(t,e)=>{const o=t.params.id;try{const t=await _dbconnect.default.query("SELECT * FROM forum WHERE id = $1",[o]);e.status(200).json(t.rows[0])}catch(t){e.status(404).json("Nicht gefunden")}};exports.getForum=getForum;const getAllForum=async(t,e)=>{try{const t=await _dbconnect.default.query("SELECT * FROM forum");e.status(200).json(t.rows)}catch(t){e.status(404).json("Nicht gefunden")}};exports.getAllForum=getAllForum;const forumViewsCount=async(t,e)=>{const o=t.body.id;try{await _dbconnect.default.query("UPDATE forum SET views = views + 1 WHERE id = $1",[o])}catch(t){e.status(404).json("Not found")}};exports.forumViewsCount=forumViewsCount;const forumLikesCount=async(t,e)=>{const o=t.body.id,s=t.body.user_id;try{await _dbconnect.default.query("UPDATE forum SET likes = likes + 1, like_ids = array_append(like_ids, $2) WHERE id = $1",[o,s])}catch(t){e.status(404).json("Not found")}};exports.forumLikesCount=forumLikesCount;const forumDislikesCount=async(t,e)=>{const o=t.body.id,s=t.body.user_id;try{await _dbconnect.default.query("UPDATE forum SET dislikes = dislikes + 1, dislike_ids = array_append(dislike_ids, $2) WHERE id = $1",[o,s])}catch(t){e.status(404).json("Not found")}};exports.forumDislikesCount=forumDislikesCount;const getAllUserForum=async(t,e)=>{const o=t.params.id;try{const t=await _dbconnect.default.query("SELECT * FROM forum WHERE user_id = $1",[o]);e.status(200).json(t.rows)}catch(t){e.status(404).json("Keine Fragen gefunden")}};exports.getAllUserForum=getAllUserForum;