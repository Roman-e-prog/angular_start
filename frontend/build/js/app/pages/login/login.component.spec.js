"use strict";var _testing=require("@angular/core/testing"),_login=require("./login.component"),_core=require("@ng-icons/core"),_ngxToastr=require("ngx-toastr"),_testing2=require("@angular/common/http/testing"),_router=require("@angular/router"),_app=require("../../app.routes"),_auth=require("../../services_interceptors/auth.service");describe("LoginComponent",(()=>{let e,t,n,o,r,i;beforeEach((async()=>{await _testing.TestBed.configureTestingModule({imports:[_login.LoginComponent,_core.NgIconsModule,_testing2.HttpClientTestingModule],providers:[(0,_core.provideIcons)({}),(0,_ngxToastr.provideToastr)(),(0,_testing2.provideHttpClientTesting)(),(0,_router.provideRouter)(_app.routes),{provider:_auth.AuthService,useValue:{user$:{id:1,vorname:"Roman",nachname:"Rostock",username:"RomanArmin",is_admin:!0}}}]}).compileComponents(),t=_testing.TestBed.createComponent(_login.LoginComponent),e=t.componentInstance,n=_testing.TestBed.inject(_auth.AuthService),o=_testing.TestBed.inject(_ngxToastr.ToastrService),r=_testing.TestBed.inject(_testing2.HttpTestingController),i=_testing.TestBed.inject(_router.Router),t.detectChanges()})),it("should create",(()=>{expect(e).toBeTruthy()})),it("should have all the fields and elements",(()=>{const e=t.debugElement.nativeElement.querySelector(".loginForm"),n=t.debugElement.nativeElement.querySelector("#username"),o=t.debugElement.nativeElement.querySelector("#email"),r=t.debugElement.nativeElement.querySelector("#password"),i=t.debugElement.nativeElement.querySelector(".mainBtn"),s=t.debugElement.nativeElement.querySelector(".forgotten");expect(e).toBeTruthy(),expect(n).toBeTruthy(),expect(o).toBeTruthy(),expect(r).toBeTruthy(),expect(i).toBeTruthy(),expect(s).toBeTruthy()})),it("should warn the user when try to use forgotten without email",(()=>{t.debugElement.nativeElement.querySelector(".forgotten").click(),t.detectChanges(),expect("Bitte geben Sie Ihre Email ein, um das Password zurückzusetzen").toBeTruthy()})),it("test the user is logged in",(()=>{const n=spyOn(i,"navigate");e.loginForm.controls.username.setValue("RomanArmin"),e.loginForm.controls.email.setValue("roman.rostock@gmail.com"),e.loginForm.controls.password.setValue("87412369");t.debugElement.nativeElement.querySelector(".mainBtn").click(),t.detectChanges();const o=r.expectOne("http://localhost:5000/api/auth/login");expect(o.request.method).toBe("POST"),o.flush({vorname:"Roman",nachname:"Rostock",username:"Roman Armin",is_admin:!0,email:"roman.rostock@gmail.com",accessToken:"123456ABCDEFG"}),expect(n).toHaveBeenCalledWith(["/dashboard"])})),it("test the forgotten is called",(async()=>{t.debugElement.nativeElement.querySelector(".loginForm");e.loginForm.controls.username.setValue("RomanArmin"),e.loginForm.controls.email.setValue("roman.rostock@gmail.com");t.debugElement.nativeElement.querySelector(".forgotten").click(),t.detectChanges();const n=r.expectOne("http://localhost:5000/api/auth/forgotten");expect(n.request.method).toBe("POST"),n.flush("Bitte öffnen Sie jetzt Ihre Email")}))}));