"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthService=void 0;var _dec,_class,_core=require("@angular/core"),_rxjs=require("rxjs"),_environment=require("../environments/environment.prod");let AuthService=exports.AuthService=(_dec=(0,_core.Injectable)({providedIn:"root"}))(_class=class{constructor(e,r,t){this.router=e,this.httpClient=r,this.toastr=t,this.userSubject=void 0,this.user=void 0;let s=null;"undefined"!=typeof window&&(s=JSON.parse(localStorage.getItem("user"))),this.userSubject=new _rxjs.BehaviorSubject(s),this.user=this.userSubject.asObservable()}get userValue(){return this.userSubject.value}login(e,r,t){return this.httpClient.post(`${_environment.environment.apiURL}api/auth/login`,{username:e,email:r,password:t}).pipe((0,_rxjs.map)((e=>{if("string"==typeof e)throw this.toastr.error(e),new Error(e);if("undefined"!=typeof window)return localStorage.setItem("user",JSON.stringify(e)),this.userSubject.next(e),e})),(0,_rxjs.catchError)((e=>{throw this.toastr.error(e.message),e})))}getUser(){if("undefined"!=typeof window){return JSON.parse(localStorage.getItem("user"))}}logout(){"undefined"!=typeof window&&(localStorage.removeItem("user"),this.userSubject.next(null),this.router.navigate(["/"]))}refreshToken(){return this.httpClient.post(`${_environment.environment.apiURL}api/auth/refreshToken`,{})}})||_class;