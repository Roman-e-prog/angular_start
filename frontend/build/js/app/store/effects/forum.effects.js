"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ForumEffect=void 0;var _dec,_class,_core=require("@angular/core"),_effects=require("@ngrx/effects"),_environment=require("../../environments/environment.prod"),_forum=require("../actions/forum.actions"),_rxjs=require("rxjs"),_forumAnswers=require("../actions/forumAnswers.actions");let ForumEffect=exports.ForumEffect=(_dec=(0,_core.Injectable)())(_class=class{constructor(r,e,t){this.store=r,this.actions$=e,this.httpClient=t,this.api_url=`${_environment.environment.apiURL}api/forum/`,this.createForum$=(0,_effects.createEffect)((()=>this.actions$.pipe((0,_effects.ofType)(_forum.createForum),(0,_rxjs.mergeMap)((r=>this.httpClient.post(this.api_url,r.forumData).pipe((0,_rxjs.map)((r=>(this.store.dispatch((0,_forum.getAllForum)()),(0,_forum.createForumSuccess)({forumData:r})))),(0,_rxjs.catchError)((r=>(0,_rxjs.of)((0,_forum.createForumError)({error:r})))))))))),this.updateForum$=(0,_effects.createEffect)((()=>this.actions$.pipe((0,_effects.ofType)(_forum.updateForum),(0,_rxjs.mergeMap)((r=>this.httpClient.put(this.api_url+r.id,r.forumData).pipe((0,_rxjs.map)((e=>(this.store.dispatch((0,_forum.getAllForum)()),this.store.dispatch((0,_forum.getForum)({id:r.id})),(0,_forum.updateForumSuccess)({forumData:e})))),(0,_rxjs.catchError)((r=>(0,_rxjs.of)((0,_forum.updateForumError)({error:r})))))))))),this.deleteForum$=(0,_effects.createEffect)((()=>this.actions$.pipe((0,_effects.ofType)(_forum.deleteForum),(0,_rxjs.mergeMap)((r=>this.httpClient.delete(this.api_url+r.id).pipe((0,_rxjs.map)((e=>(this.store.dispatch((0,_forum.getAllForum)()),(0,_forum.deleteForumSuccess)({id:r.id})))),(0,_rxjs.catchError)((r=>(0,_rxjs.of)((0,_forum.deleteForumError)({error:r})))))))))),this.getForum$=(0,_effects.createEffect)((()=>this.actions$.pipe((0,_effects.ofType)(_forum.getForum),(0,_rxjs.mergeMap)((r=>this.httpClient.get(this.api_url+"find/"+r.id).pipe((0,_rxjs.map)((e=>(this.store.dispatch((0,_forumAnswers.getAllAnswersToQuestion)({id:r.id})),(0,_forum.getForumSuccess)({forumData:e})))),(0,_rxjs.catchError)((r=>(0,_rxjs.of)((0,_forum.getForumError)({error:r})))))))))),this.getAllForum$=(0,_effects.createEffect)((()=>this.actions$.pipe((0,_effects.ofType)(_forum.getAllForum),(0,_rxjs.mergeMap)((r=>this.httpClient.get(this.api_url+"find/").pipe((0,_rxjs.map)((r=>(0,_forum.getAllForumSuccess)({data:r}))),(0,_rxjs.catchError)((r=>(0,_rxjs.of)((0,_forum.getAllForumError)({error:r})))))))))),this.getAllUserQuestions$=(0,_effects.createEffect)((()=>this.actions$.pipe((0,_effects.ofType)(_forum.getAllUserQuestions),(0,_rxjs.mergeMap)((r=>this.httpClient.get(this.api_url+"allUserQuestions/"+r.id).pipe((0,_rxjs.map)((r=>(0,_forum.getAllUserQuestionsSuccess)({data:r}))),(0,_rxjs.catchError)((r=>(0,_rxjs.of)((0,_forum.getAllUserQuestionsError)(r))))))))))}})||_class;